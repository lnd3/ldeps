cmake_minimum_required (VERSION 3.0.2)

if(NOT DEFINED deps_jsonxx OR deps_jsonxx)
############################ jsonxx ############################
file(GLOB_RECURSE jsonxx_inc ${CMAKE_CURRENT_SOURCE_DIR}/jsonxx/jsonxx/jsonxx.h)
file(GLOB_RECURSE jsonxx_src ${CMAKE_CURRENT_SOURCE_DIR}/jsonxx/jsonxx/jsonxx.cc)

add_library(jsonxx STATIC ${jsonxx_inc} ${jsonxx_src})
target_include_directories(jsonxx PUBLIC ${CMAKE_CURRENT_SOURCE_DIR}/jsonxx)
set_target_properties(jsonxx PROPERTIES FOLDER "Deps/jsonxx")

target_compile_definitions(jsonxx PUBLIC cxx_std_17)
if(MSVC)
	target_compile_options(jsonxx PRIVATE /W1)
else()
	target_compile_options(jsonxx PRIVATE -Werror)
endif()
endif()

if(NOT DEFINED deps_curl OR deps_curl)
############################ CURL ############################
set(BUILD_SHARED_LIBS False)
set(BUILD_STATIC_LIBS True)
set(BUILD_TESTING False)
#set(CURL_CA_FALLBACK On)
set(CURL_ENABLE_SSL True)
set(CURL_USE_SCHANNEL True)
set(CURL_WINDOWS_SSPI True)
#set(ENABLE_CURL_DEBUG On)
#set(ENABLE_DEBUG On)
#set(ENABLE_UNIX_SOCKETS On)
set(ENABLE_WEBSOCKETS True)
set(USE_WIN32_LDAP True)
add_subdirectory(curl)
set_target_properties(curl PROPERTIES FOLDER "Deps/curl")
set_target_properties(curl_uninstall PROPERTIES FOLDER "Deps/curl")
set_target_properties(libcurl_static PROPERTIES FOLDER "Deps/curl")
set_target_properties(libcurl_object PROPERTIES FOLDER "Deps/curl")
set_target_properties(curltool PROPERTIES FOLDER "Deps/curl")
target_compile_definitions(libcurl_object PUBLIC CURL_ENABLE_SSL USE_WINDOWS_SSPI USE_SCHANNEL)
endif()

if(NOT DEFINED deps_mongoose OR deps_mongoose)
############################ Mongoose ############################
add_library(mongoose STATIC mongoose/mongoose/mongoose.h mongoose/mongoose/mongoose.c)
target_include_directories(mongoose PUBLIC mongoose)
set_target_properties(mongoose PROPERTIES FOLDER "Deps/mongoose")

target_compile_definitions(mongoose PUBLIC cxx_std_17)
if(MSVC)
	target_compile_options(mongoose PRIVATE /W0)
else()
	target_compile_options(mongoose PRIVATE -Werror)
endif()
endif()
